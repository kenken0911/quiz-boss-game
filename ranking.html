<!DOCTYPE html>

<html lang="ja">

<head>

Â  <meta charset="UTF-8">

Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">

Â  <title>ğŸ† Sustainable Quest - Ranking ğŸ†</title>

Â  <script src="https://cdn.tailwindcss.com"></script>

Â  <link rel="preconnect" href="https://fonts.googleapis.com">

Â  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

Â  <link href="https://fonts.googleapis.com/css2?family=DotGothic16&family=Press+Start+2P&display=swap" rel="stylesheet">

Â  <style>

Â  Â  body {

Â  Â  Â  font-family: 'DotGothic16', sans-serif;

Â  Â  Â  background-color: #000;

Â  Â  Â  color: #fff;

Â  Â  Â  background-image: url('https://images.unsplash.com/photo-1531366936337-7c912a4589a7?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D');

Â  Â  Â  background-size: cover;

Â  Â  Â  background-position: center;

Â  Â  Â  background-attachment: fixed;

Â  Â  }

Â  Â  .dq-window { border: 4px solid #fff; background: rgba(0,0,80,0.85); padding: 1.5rem; box-shadow: 0 0 0 4px #000, 0 0 20px rgba(0,128,255,0.6); backdrop-filter: blur(3px); }

Â  Â  th { border-bottom: 2px solid #fff; line-height: 1.4; }

Â  Â  td { border-bottom: 1px solid #555; }

Â  Â  .rank-1 { color: #ffd700; font-weight: bold; text-shadow: 0 0 5px #ffd700; }

Â  Â  .rank-2 { color: #c0c0c0; font-weight: bold; }

Â  Â  .rank-3 { color: #cd7f32; font-weight: bold; }

Â  </style>

</head>

<body class="p-4 md:p-8">

Â  <div class="dq-window max-w-4xl mx-auto">

Â  Â  <h1 class="text-3xl md:text-4xl text-center font-bold mb-6 text-yellow-300" style="font-family: 'Press+Start+2P', cursive;">ğŸ† RANKING ğŸ†</h1>

Â  Â  <div class="overflow-x-auto">

Â  Â  Â  <table class="w-full text-left text-lg">

Â  Â  Â  Â  <thead>

Â  Â  Â  Â  Â  <tr>

Â  Â  Â  Â  Â  Â  <th class="p-2 text-center">Rank<br>(é †ä½)</th>

Â  Â  Â  Â  Â  Â  <th class="p-2">Nickname<br>(ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ )</th>

Â  Â  Â  Â  Â  Â  <th class="p-2">Company<br>(æ‰€å±ä¼šç¤¾)</th>

Â  Â  Â  Â  Â  Â  <th class="p-2 text-center">Score<br>(åˆè¨ˆã‚¹ã‚³ã‚¢)</th>

Â  Â  Â  Â  Â  </tr>

Â  Â  Â  Â  </thead>

Â  Â  Â  Â  <tbody id="ranking-body">

Â  Â  Â  Â  Â  <!-- ãƒ‡ãƒ¼ã‚¿ã¯JavaScriptã§ã“ã“ã«æŒ¿å…¥ã•ã‚Œã¾ã™ -->

Â  Â  Â  Â  </tbody>

Â  Â  Â  </table>

Â  Â  </div>

Â  Â  <p id="loading-message" class="text-center text-xl mt-4">ãƒ©ãƒ³ã‚­ãƒ³ã‚°é›†è¨ˆä¸­...</p>

Â  Â  <p id="updated-time" class="text-center text-sm mt-4 text-gray-400"></p>

Â  </div>



Â  <script>

Â  Â  // â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…

Â  Â  // â˜… GASã‚’å†ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸå¾Œã®ã€Œæ–°ã—ã„ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®URLã€ã‚’ã“ã“ã«è¨­å®šã—ã¦ãã ã•ã„ â˜…

Â  Â  // â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…

Â  Â  const GAS_URL = 'https://script.google.com/macros/s/AKfycbzKjQfG-cW1tacggfb1JrGa8oT2iAqtgmdmeUb_wCdmMb3h78CXLgIiPVXsLXoMFdpHtQ/exec';



Â  Â  async function fetchRanking() {

Â  Â  Â  const rankingBody = document.getElementById('ranking-body');

Â  Â  Â  const loadingMessage = document.getElementById('loading-message');

Â  Â  Â  const updatedTimeEl = document.getElementById('updated-time');

Â  Â  Â  

Â  Â  Â  try {

Â  Â  Â  Â  const response = await fetch(GAS_URL);

Â  Â  Â  Â  if (!response.ok) {

Â  Â  Â  Â  Â  throw new Error(`Network response was not ok: ${response.statusText}`);

Â  Â  Â  Â  }

Â  Â  Â  Â  const data = await response.json();



Â  Â  Â  Â  if (data.error) {

Â  Â  Â  Â  Â  throw new Error(data.error);

Â  Â  Â  Â  }



Â  Â  Â  Â  if (data.length === 0) {

Â  Â  Â  Â  Â  loadingMessage.textContent = 'ã¾ã æŒ‘æˆ¦è€…ãŒã„ã¾ã›ã‚“ã€‚';

Â  Â  Â  Â  Â  return;

Â  Â  Â  Â  }



Â  Â  Â  Â  let tableHtml = '';

Â  Â  Â  Â  data.forEach((player, index) => {

Â  Â  Â  Â  Â  const rank = index + 1;

Â  Â  Â  Â  Â  let rankClass = '';

Â  Â  Â  Â  Â  if (rank === 1) rankClass = 'rank-1';

Â  Â  Â  Â  Â  if (rank === 2) rankClass = 'rank-2';

Â  Â  Â  Â  Â  if (rank === 3) rankClass = 'rank-3';



Â  Â  Â  Â  Â  tableHtml += `

Â  Â  Â  Â  Â  Â  <tr class="${rankClass}">

Â  Â  Â  Â  Â  Â  Â  <td class="p-2 text-center">${rank}</td>

Â  Â  Â  Â  Â  Â  Â  <td class="p-2">${escapeHtml(player.nickname)}</td>

Â  Â  Â  Â  Â  Â  Â  <td class="p-2">${escapeHtml(player.company)}</td>

Â  Â  Â  Â  Â  Â  Â  <td class="p-2 text-center">${player.totalScore}</td>

Â  Â  Â  Â  Â  Â  </tr>

Â  Â  Â  Â  Â  `;

Â  Â  Â  Â  });



Â  Â  Â  Â  rankingBody.innerHTML = tableHtml;

Â  Â  Â  Â  loadingMessage.style.display = 'none';

Â  Â  Â  Â  

Â  Â  Â  Â  const now = new Date();

Â  Â  Â  Â  updatedTimeEl.textContent = `æœ€çµ‚æ›´æ–°: ${now.toLocaleString('ja-JP')}`;



Â  Â  Â  } catch (error) {

Â  Â  Â  Â  console.error('ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);

Â  Â  Â  Â  loadingMessage.textContent = 'ã‚¨ãƒ©ãƒ¼ï¼šãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚';

Â  Â  Â  }

Â  Â  }



Â  Â  function escapeHtml(unsafe) {

Â  Â  Â  Â  return unsafe

Â  Â  Â  Â  Â  Â  Â .replace(/&/g, "&amp;")

Â  Â  Â  Â  Â  Â  Â .replace(/</g, "&lt;")

Â  Â  Â  Â  Â  Â  Â .replace(/>/g, "&gt;")

Â  Â  Â  Â  Â  Â  Â .replace(/"/g, "&quot;")

Â  Â  Â  Â  Â  Â  Â .replace(/'/g, "&#039;");

Â  Â  Â }



Â  Â  // ãƒšãƒ¼ã‚¸ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã‚‰ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’å–å¾—

Â  Â  window.onload = fetchRanking;

Â  </script>

</body>

</html>
